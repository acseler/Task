<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>SIMPLE TODO LISTS</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/bootstrap-datepicker.css">
    <meta name="viewport" content="width=device-width,
									initial-scale=1.0,
									maximum-scale=1.0,
									user-scalable=no">
</head>
<body ng-app="TaskManager" ng-controller="projectController" ng-init="taskToUpdate = {data: ''};
                                                                        projectToUpdate = {data: ''};
                                                                        createEdit = {data: ''};
                                                                        loginFlag = true">
<div class="container">
    <div class="row">
        <header class="header">
            <div class="container">
                <h3 class="text-center"><strong>SIMPLE TODO LISTS</strong></h3>
                <p class="text-center">FROM RUBY GARAGE</p>
            </div>
        </header>
    </div>
</div>

<div class="container" ng-show="loginFlag == true" ng-init="loginSuccess = true">
    <div class="row">
        <form class="col-md-offset-3 col-md-6">
            <div class="row">
                <h3 class="text-center">
                    Welcome to Task manager
                </h3>
            </div>
            <div class="form-group">
                <label for="login" class="control-label">Login</label>
                <input type="text" id="login" class="form-control"/>
            </div>
            <div class="form-group">
                <label for="password" class="control-label">Password</label>
                <input type="password" id="password" class="form-control"/>
                <p ng-show="loginSuccess != true" class="has-error">Login or password incorrect</p>
            </div>
            <button type="button" class="btn btn-primary col-md-12" ng-click="login()">Log in</button>
        </form>
    </div>
</div>

<div class="container"  ng-show="loginFlag == false">
    <div class="row">
        <div class="col-md-offset-1 col-md-10">
            <div class="panel panel-primary" ng-repeat="p in projects">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-8">{{p.name}}</div>
                        <div class="col-md-4">
                            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#createProject"
                                    ng-click="projectToUpdate.data = p; editProject(projectToUpdate.data.name)">
                                edit
                            </button>
                            <button type="button" class="btn btn-default" ng-click="deleteProject(p)">delete</button>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <thead>
                    <input type="text" ng-model="taskName"/>
                    <button class="btn btn-primary btn-sm" ng-click="addTask(p.id, taskName)">
                        Add task
                    </button>
                    </thead>
                    <tr ng-repeat="task in p.tasks | orderBy:'-priority'" ng-click="rowSelected(task)">
                        <td>
                            <div class="row">
                                <div class="col-md-1">
                                    <input type="checkbox" id="taskStatus" ng-checked="task.status == 'Done'" ng-click="taskDone(task)"/>
                                </div>
                                <div class="col-md-4">
                                    {{task.name}}
                                </div>
                                <div class="col-md-2">
                                    {{task.deadlineDate}}
                                </div>
                                <div class="col-md-1">
                                    <div class="full-circle red" ng-show="task.priority == 3"></div>
                                    <div class="full-circle yellow" ng-show="task.priority == 2"></div>
                                    <div class="full-circle green" ng-show="task.priority == 1"></div>
                                </div>
                                <div class="col-md-2">
                                    <div ng-show="true">
                                        <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#updateModal"
                                                ng-click="taskToUpdate.data = task; callEditTask(taskToUpdate.data);">edit
                                        </button>
                                        <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#deleteModal"
                                                ng-click="deleteTask(task)">delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-offset-4 col-md-4">
            <button class="btn btn-primary btn-lg col-md-12" data-toggle="modal" data-target="#createProject" ng-click="modalClear()">Add TODO List</button>
        </div>
    </div>

    <!-- Modal  update task-->
    <div id="updateModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Edit task</h4>
                </div>
                <div class="modal-body col-md-12">
                    <form>
                        <div class="form-group">
                            <label for="taskName">Task name</label>
                            <input type="text" class="form-control" id="taskName"/>
                        </div>
                        <div class="form-group">
                            <label for="datapicker" class="control-label">Deadline</label>
                            <input type="text" class="span2 form-control" id="datapicker">
                        </div>
                        <div class="form-group">
                            <label for="selectPriority">Choose priority</label>
                            <select class="form-control" id="selectPriority">
                                <option value="1">Low</option>
                                <option value="2">Medium</option>
                                <option value="3">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="status" class="control-label">Status</label>
                            <select class="form-control" id="status">
                                <option value="In process">In process</option>
                                <option value="Done">Done</option>
                            </select>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" ng-click="updateForTask(taskToUpdate.data)"
                            data-dismiss="modal">Save
                    </button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal create project-->
    <div id="createProject" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" ng-show="createEdit.data == true">Create project</h4>
                    <h4 class="modal-title" ng-show="createEdit.data == false">Edit project</h4>
                </div>
                <div class="modal-body col-md-12">
                    <form>
                        <label for="projectName" class="control-label">Project name</label>
                        <input type="text" class="form-control" id="projectName" ng-model="projectName"/>
                    </form>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                            ng-click="createProject(projectName)" ng-show="createEdit.data == true">Create
                    </button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                            ng-click="updateProject(projectToUpdate.data)" ng-show="createEdit.data == false">Save
                    </button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>

        </div>
    </div>
</div>
<footer>
    <div class="container">
        <p class="text-center">&copy; Ruby Garage</p>
    </div>
</footer>
<script src="scripts/jquery-1.12.1.min.js"></script>
<script src="scripts/bootstrap.min.js"></script>
<script src="scripts/angular.js"></script>
<script src="scripts/angular-animate.js"></script>
<script src="scripts/angular-cookies.js"></script>
<script src="scripts/bootstrap-datepicker.js"></script>
<script src="scripts/app.js"></script>
<script src="scripts/taskManager.js"></script>
</body>
</html>